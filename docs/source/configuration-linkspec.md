# Link configuration and linkspec

## Link configuration file

At the heart of each `link` operation is a YAML configuration file, which defines how symbolic links should be created to make a Unity project. By default, the file is named `upkit.yaml`, and can be changed to whatever needed. A typical configuration should look like this:

```yaml
params:
  project: '{{__dir__}}/project'
  project_packages: '{{__dir__}}/packages'

links:
  - source: '{{project_packages}}/Scripts'
    target: '{{__assets__}}/Scripts'
```

### Parameters

To make linking more configurable, there are two types of parameters supported by Upkit: 
* **Built-in parameters:** those with name enclosed by `__`, for instance `__dir__` and `__assets__`, are generated by Upkit and shall not be defined. The list of built-in parameters are defined [here](#builtin-parameters).
* **User parameters:** those defined by user, under `params` section.

For each configuration file, there *MUST* be a `project` parameter defined, which tells Upkit where to generate the links. 
 
#### Defining and expanding parameters
Defining a parameter can be as simple as:

```yaml
params:
  some_param: 'some value'
```

However, most of the time, parameters are defined by expanding other existing parameters using Jinja syntax, such as:
```yaml
params:
  platform: 'ios'
  project: '{{__dir__}}/project-{{platform}}'
  project_settings: '{{project}}/ProjectSettings'
```

#### Builtin parameters

The table below describes Upkit built-in parameters. 

| Name          | Description                                                               |
|---------------|---------------------------------------------------------------------------|
| `__cwd__`     | Path to current working folder.                                           |
| `__dir__`     | Path to the folder containing the current configuration or linkspec file. |
| `__project__` | Path to the Unity project.                                                |
| `__assets__`  | Path to the Unity project's Assets folder.                                |
| `__plugins__` | Path to the Unity project's Plugins folder.                               |
| `__source__`  | The source parameter in a linkspec.                                       |
| `__target__`  | The target parameter in a linkspec.                                       |

Note that only `__cwd__` and `__dir__` are accessible in `params` section. 

#### Overwriting parameters

Given a configuration, its user-defined parameters can be overwriten at runtime by passing `-p name=value` to the `link` command. This is particularly useful when you need to use the configuration file as a template for multiple Unity projects with slightly different parameters. For example, a configuration for multiple platforms may look like: 

```yaml
params:
  platform: 'ios'
  project: '{{__dir__}}/project-{{platform}}'
...
```

Execute the following commands:
```
$ upkit link
$ upkit link -p platform=android
$ upkit link -p platform=windows 
```

will create `project-ios`, `project-android` and `project-windows` as separate Unity project folders.

### Linkspec

To generate Unity projects, a list of link specifications, or *linkspec*s in short, must be defined under `links` section. Basically, a linkspec is a way to tell Upkit where to find a package, which of its content (all or partial) and a target to which the content is linked. 

#### Defining local sources


#### Linkspec 

#### Link a local file or folder

#### Link a set of files in a local folder

#### Link a Nuget package 

#### Link a Git package


## Package linkspec

### Overwrite package linkspec
